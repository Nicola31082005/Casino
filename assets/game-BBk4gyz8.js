import"./output-Bw6ZNiap.js";import{g as y}from"./index-DjKJqAo0.js";function P(){let t=localStorage.getItem("userId");return t||(t=`user_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,localStorage.setItem("userId",t)),t}async function S(t,r=1){return new Promise((e,i)=>{const o=indexedDB.open(t,r);o.onupgradeneeded=c=>{const n=c.target.result;n.objectStoreNames.contains("userCoins")||n.createObjectStore("userCoins",{keyPath:"id"})},o.onsuccess=()=>e(o.result),o.onerror=()=>i(o.error)})}async function L(t,r){const e=await S("casinoGameDB");return new Promise((i,o)=>{const n=e.transaction("userCoins","readwrite").objectStore("userCoins"),a={id:t,coins:r,lastUpdated:new Date().toISOString()},u=n.put(a);u.onsuccess=()=>i(),u.onerror=()=>o(u.error)})}async function v(t){const r=await S("casinoGameDB");return new Promise((e,i)=>{const n=r.transaction("userCoins","readonly").objectStore("userCoins").get(t);n.onsuccess=()=>{const a=n.result;e(a?a.coins:null)},n.onerror=()=>i(n.error)})}const w=["🍒","🍋","🍊","🍉","⭐","💎"],D=3,k=[["🍒","🍒","🍒"],["⭐","⭐","⭐"],["💎","💎","💎"]];let f,d;(async()=>{var C;f=P(),d=await v(f)||0;const t=document.getElementById("balance");t.textContent=d.toString();const r=document.getElementById("game-message"),e=document.getElementById("result-modal"),i=document.getElementById("result-title"),o=document.getElementById("result-description"),c=document.getElementById("close-modal"),n=document.querySelector("#gather-coins-button");let a=!1;function u(s){d+=s,t.textContent=d.toString(),L(f,d)}function b(){a=!0;const s=document.querySelectorAll(".reel"),l=Array.from({length:D},()=>w[Math.floor(Math.random()*w.length)]),g=[];return s.forEach((m,h)=>{const E=1+h*.5,x=new Promise(B=>{y.to(m,{y:-300,repeat:2,duration:E,ease:"power2.inOut",onComplete:()=>{y.set(m,{y:0}),m.textContent=l[h],B()}})});g.push(x)}),Promise.all(g).then(()=>l)}function I(s){return k.some(l=>l.every((g,m)=>s[m]===g))}(C=document.getElementById("spin-button"))==null||C.addEventListener("click",async()=>{if(d<=0){r.textContent="You are out of coins!";return}if(a)return;u(-10),r.textContent="Spinning...";const s=await b();I(s)?(u(50),p("You Win!","Congratulations! You won 50 coins!")):p("You Lose","Better luck next time!")});function p(s,l){r.textContent="Press the Spin button to try your luck!",a=!1,i.textContent=s,o.textContent=l,e.classList.remove("hidden"),e.classList.add("flex"),y.to(e,{opacity:1,duration:.5})}c==null||c.addEventListener("click",()=>{e.classList.add("hidden"),y.to(e,{opacity:0,duration:.5,onComplete:()=>{e.classList.add("hidden"),e.classList.remove("flex")}})}),n==null||n.addEventListener("click",()=>{window.confirm("Do you want to add coins in your budget?")&&u(50)})})();
